# go GMP调度原理

# go GMP调度原理

本文介绍了Go语言中GMP调度器的工作原理。GMP调度器是Go语言运行时系统中的核心组件之一，用于协调和管理Go协程的执行。

GMP调度器由三个组件组成：Goroutine、M（Machine）、P（Processor）。其中，Goroutine是Go语言中的协程，M是执行协程的执行器，P是协程调度的管理器。

当一个Goroutine被创建时，它会被放入一个全局的Goroutine队列中。当M空闲时，它会从队列中获取一个Goroutine并将其放入一个本地的Goroutine队列中。当M需要执行一个Goroutine时，它会从本地队列中获取一个Goroutine进行执行。

当一个M处理完一个Goroutine时，它会检查是否存在其他可执行的Goroutine。如果本地队列为空，M会从其他M的队列中窃取一些Goroutine并放入本地队列中，以保证M的执行能力不会浪费。

P的作用是管理Goroutine的调度。P有两种类型：工作P和空闲P。工作P用于执行Goroutine，而空闲P则处于等待状态，直到有新的Goroutine需要执行。当一个Goroutine需要执行时，P会从工作P池中获取一个工作P，并将Goroutine放入该P的本地队列中。

当一个工作P的队列为空时，它会尝试从其他工作P的队列中窃取一些Goroutine，并将其放入自己的队列中。这样可以保证所有的P都能充分利用资源，从而提高系统的并发性能。

总之，GMP调度器是Go语言运行时系统中的核心组件之一，负责协调和管理Go协程的执行。通过合理地利用M和P的资源，GMP调度器可以实现高效的并发调度，从而提高系统的性能和可靠性。